{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/jpg" href="{{ url_for('static', filename='pictures/fav.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/ai-style.css') }}">
    
    <title>Chatbot</title>
</head>
<body>
    <header>
        <div class="div-left">
            <h1 class="header-text">Practicum</h1>
        </div>
        <div-right id="div-right">
            
           
            <a href="/profile_student">
                <button type="submit" class="button1"><h1 class="menu-text">Profile</h1></button>
            </a>
            
        </div-right>
    </header>
    <div id="main">
        <div id="questions-form">
            <form action="/chatbot" method="post">
                <div class="text">
                    <button class="button2"  type="submit" onclick="toggleAnswer1(this)">Generate</button>
                    <h2>Enter your text</h2>
                    <textarea id="context" placeholder="Type your text..." name="context"></textarea>
                </div>
                <div id="choose">
                    <div id="left-choose">
                        <div id="quest-type">
                            <div>
                                <h3>Question type:</h3>
                            </div>  
                                <select id="questiontype" name="questiontype" class="option">
                                    <option value="shortans">Short answer</option>
                                </select>
                        </div>
                        <div id="diff">
                            <div>
                                <h3>Difficulty: </h3>
                            </div>
                                <select id="difficulty" name="difficulty" class="option">
                                    <option value="easy">Easy</option>
                                    <option value="medium">Medium</option>
                                    <option value="hard">Hard</option>
                                </select>
                        </div>
                    </div>
                    <div id="right-choose">
                        <div id="lang">
                            <div>
                                <h3>Language:</h3>
                            </div>    
                                <select id="language" name="language" class="option">
                                <option value="english">English</option>
                                </select>
                        </div>
                        <div id="max">
                            <div>
                                <h3>Max questions:</h3>
                            </div>
                                <select id="num_questions" name="num_questions" class="option">
                                <option value="1">1</option>
                                <option value="5">5</option>
                                <option value="10">10</option>
                                <option value="15">15</option>
                                </select>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <script>
            function toggleAnswer(button) {
                var answerItem = button.parentNode.nextElementSibling;
                var answer = answerItem.querySelector('.ans');
                if (answer.style.display === "none" || answer.style.display === "") {
                    answer.style.display = "flex";
                    button.textContent = "Hide Answer";
                } else {
                    answer.style.display = "none";
                    button.textContent = "Reveal Answer";
                }
            }
        </script>
        <div class="ai_result">
            <div class="loading-container">
                <div class="loading"></div>
                <div id="loading-text">Waiting for your content</div>
            </div>
            <ul class="questions_answers">
                {% for item in questions_answers %}
                <li class="li">
                    <p>{{ loop.index }}. {{ item['question'] }}</p>
                    <br>
                    <textarea placeholder="Type your answer here..."></textarea>
                    <button class="revansw" onclick="toggleAnswer(this)">Reveal Answer</button>
                </li>
                <li style="list-style-type: none;">
                    <div class="ans"><p>{{ item['answer'] }}</p></div>
                </li>
                {% endfor %}
            </ul>
        </div>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
        fetch('/chatbot', {
            method: 'POST',
            body: new FormData(document.getElementById('generate-form'))
        })
        .then(response => response.json())
        .then(data => {
            const loadingContainer = document.querySelector('.loading-container');
            const aiResult = document.querySelector('.ai_result'); // Get the AI result container
            loadingContainer.style.display = "none"; // Hide the loading container
            aiResult.style.display = "block"; // Show the AI result container

            
            const questionsAnswers = data.questions_answers;
            const ul = document.querySelector('.questions_answers');
            questionsAnswers.forEach(item => {
                const li = document.createElement('li');
                li.className = 'li';
                li.innerHTML = `
                    <p>${item['question']}</p>
                    <br>
                    <textarea placeholder="Type your answer here..."></textarea>
                    <button class="revansw" onclick="toggleAnswer(this)">Reveal Answer</button>
                    <li style="list-style-type: none;">
                        <div class="ans"><p>${item['answer']}</p></div>
                    </li>
                `;
                ul.appendChild(li);
            });
        })
        .catch(error => {
            console.error('Error:', error);
            const loadingText = document.getElementById('loading-text');
            loadingText.textContent = 'Error loading content';
            });
        });
        </script>
        
        
        
        </script>
    
    </div>
    
    
    
    <div class="footer">
        <div class="idk">
            <h1><u>Terms of service</u></h1>
            <h1><u>About us</u></h1>
            <h1><u>Manage Cookies</u></h1>
            <h1><u>Privacy policy</u></h1>
        </div>
        <h2>Copyright &copy 2024 all rights reserved</h2>
    </div>
    
</body>
</html>
{% endblock %}